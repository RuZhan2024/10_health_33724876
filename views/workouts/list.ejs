<%- include('../partials/header', { pageTitle: pageTitle || 'My Workouts' }) %>

<section class="workouts">
  <h2>My Workouts</h2>

  <div class="workouts-actions">
    <a href="/workouts/add" class="btn">Add Workout</a>
  </div>

  <section class="workouts-filters">
    <h3>Filter</h3>
    <form method="GET" action="/workouts">
      <div class="form-row">
        <div class="form-group">
          <label for="type">Workout type</label>
          <select name="type" id="type">
            <option value="">All types</option>
            <% workoutTypes.forEach(t => { %>
              <option value="<%= t.id %>" <%= String(filters.type) === String(t.id) ? 'selected' : '' %>>
                <%= t.name %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="form-group">
          <label for="from">From date</label>
          <input
            type="date"
            id="from"
            name="from"
            value="<%= filters.from || '' %>"
          />
        </div>

        <div class="form-group">
          <label for="to">To date</label>
          <input
            type="date"
            id="to"
            name="to"
            value="<%= filters.to || '' %>"
          />
        </div>

        <div class="form-group">
          <label>&nbsp;</label>
          <button type="submit" class="btn">Apply</button>
        </div>
      </div>
    </form>
  </section>

  <section class="workouts-list">
    <% if (!workouts.length) { %>
      <p>No workouts found. Try adjusting your filters or
        <a href="/workouts/add">add a new workout</a>.
      </p>
    <% } else { %>
      <table class="table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Duration (min)</th>
            <th>Intensity</th>
            <th>Notes</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% workouts.forEach(w => { %>
            <tr>
              <td><%= w.workout_date_str %></td>
              <td><%= w.workout_type_name %></td>
              <td><%= w.duration_minutes %></td>
              <td><%= w.intensity %></td>
              <td><%= w.notes || '' %></td>
              <td>
                <a href="/workouts/<%= w.id %>/edit">Edit</a>
                <form
                  action="/workouts/<%= w.id %>/delete"
                  method="POST"
                  style="display:inline"
                  onsubmit="return confirm('Delete this workout?');"
                >
                  <button type="submit" class="link-button">Delete</button>
                </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    <% } %>
  </section>
</section>

<%- include('../partials/footer') %>
